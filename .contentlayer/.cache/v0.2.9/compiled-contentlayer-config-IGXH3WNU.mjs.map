{
  "version": 3,
  "sources": ["../../../contentlayer.config.ts", "../../../lib/constants.ts", "../../../lib/rehyePrettyCode.ts"],
  "sourcesContent": ["import { defineDocumentType, makeSource } from \"contentlayer/source-files\";\nimport dayjs from \"dayjs\";\nimport rehypeAutolinkHeadings from \"rehype-autolink-headings\";\nimport rehypePrettyCode from \"rehype-pretty-code\";\nimport rehypeSlug from \"rehype-slug\";\nimport remarkGfm from \"remark-gfm\";\nimport { HEADING_LINK_ANCHOR } from \"./lib/constants\";\nimport {\n  rehypePrettyCodeClasses,\n  rehypePrettyCodeOptions,\n} from \"./lib/rehyePrettyCode\";\nimport GithubSlugger from \"github-slugger\";\n\nexport const Blog = defineDocumentType(() => ({\n  name: \"Blog\",\n  contentType: \"mdx\",\n  filePathPattern: `*.mdx`,\n  fields: {\n    title: { type: \"string\", required: true },\n    publishedAt: { type: \"string\", required: true },\n    description: { type: \"string\" },\n    status: { type: \"enum\", options: [\"draft\", \"published\"], required: true },\n  },\n  computedFields: {\n    headings: {\n      type: \"json\",\n      resolve: async (doc) => {\n        const slugger = new GithubSlugger();\n        const regexp = /(?<flag>#{1,6})\\s+(?<content>.+)/g;\n        console.log(doc.body.raw);\n        const headings = Array.from(doc.body.raw.matchAll(regexp)).map(\n          ({ groups }) => {\n            const flag = groups?.flag;\n            const content = groups?.content;\n            return {\n              heading: flag?.length,\n              text: content,\n              slug: content ? slugger.slug(content) : undefined,\n            };\n          }\n        );\n\n        return headings;\n      },\n    },\n\n    publishedAtFormatted: {\n      type: \"string\",\n      resolve: (doc) => {\n        return dayjs(doc.publishedAt).format(\"MMMM D, YYYY\");\n      },\n    },\n    slug: {\n      type: \"string\",\n      resolve: (doc) => `/blogs/${doc._raw.flattenedPath}`,\n    },\n  },\n}));\n\nexport default makeSource({\n  contentDirPath: \"blogs\",\n  documentTypes: [Blog],\n  mdx: {\n    esbuildOptions(options) {\n      options.target = \"esnext\";\n      return options;\n    },\n    remarkPlugins: [[remarkGfm]],\n    rehypePlugins: [\n      [rehypeSlug],\n      [rehypePrettyCode, rehypePrettyCodeOptions],\n      [rehypePrettyCodeClasses],\n      [\n        rehypeAutolinkHeadings,\n        {\n          behavior: \"wrap\",\n          properties: {\n            className: [HEADING_LINK_ANCHOR],\n          },\n        },\n      ],\n    ],\n  },\n});\n", "export const FOCUS_VISIBLE_OUTLINE = `focus:outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-main`;\n\nexport const LINK_STYLES = `text-primary-main dark:text-secondary-main dark:decoration-secondary-main underline decoration-primary-main underline-offset-2 transition-all hover:text-primary-main hover:decoration-primary-main`;\n\nexport const LINK_SUBTLE_STYLES = `hover:underline hover:decoration-primary-main hover:underline-offset-2 hover:text-primary-main  dark:text-secondary-main dark:decoration-secondary-main`;\n\nexport const HEADING_LINK_ANCHOR = `before:content-['#'] before:absolute before:-ml-[1em] dark:before:text-secondary-main dark:hover:before:text-secondary-main before:text-primary-main hover:before:text-primary-main pl-[1em] -ml-[1em]`;\n", "import { type Options } from \"rehype-pretty-code\";\nimport { visit } from \"unist-util-visit\";\n\n// div.BLOCK > pre.PRE > code.CODE\nconst BLOCK =\n  \"overflow-hidden rounded-lg bg-primary-dark shadow-md  shadow-surface-elevation-low ring-1 ring-primary-main/[3%] ring-inset\";\nconst TITLE =\n  \"mb-0.5  bg-primary-light   px-3 py-1 font-mono text-xs text-secondary-main shadow-sm\";\nconst PRE = \"overflow-x-auto p-2 text-[13px] leading-6\";\nconst CODE =\n  \"grid [&>span]:border-l-4 [&>span]:border-l-transparent [&>span]:pl-2 [&>span]:pr-3\";\nconst INLINE_BLOCK =\n  \"whitespace-nowrap border border-primary-main/10 px-1.5 py-px text-[12px] rounded-full bg-seconday-main/5 whitespace-nowrap text-primary-main dark:text-secondary-main\";\nconst INLINE_CODE = \"\";\nconst NUMBERED_LINES =\n  \"[counter-reset:line] before:[&>span]:mr-3 before:[&>span]:inline-block before:[&>span]:w-4 before:[&>span]:text-right before:[&>span]:text-white/20 before:[&>span]:![content:counter(line)] before:[&>span]:[counter-increment:line]\";\nconst HIGHLIGHTED_LINE =\n  \"!border-l-primary-main/70 bg-primary-main/10 before:!text-seconday-main/70\";\n\nexport function rehypePrettyCodeClasses() {\n  return (tree: any) => {\n    visit(\n      tree,\n      (node: any) =>\n        Boolean(\n          node.tagName === \"code\" &&\n            Object.keys(node.properties).length === 0 &&\n            node.children.some((n: any) => n.type === \"text\")\n        ),\n      (node: any) => {\n        const textNode = node.children.find((n: any) => n.type === \"text\");\n        textNode.type = \"element\";\n        textNode.tagName = \"code\";\n        textNode.properties = { className: [INLINE_CODE] };\n        textNode.children = [{ type: \"text\", value: textNode.value }];\n        node.properties.className = [INLINE_BLOCK];\n\n        node.tagName = \"span\";\n      }\n    );\n\n    visit(\n      tree,\n      (node: any) =>\n        Boolean(\n          typeof node?.properties?.[\"data-rehype-pretty-code-fragment\"] !==\n            \"undefined\"\n        ),\n      (node: any) => {\n        if (node.tagName === \"span\") {\n          node.properties.className = [\n            ...(node.properties.className || []),\n            INLINE_BLOCK,\n          ];\n          node.children[0].properties.className = [\n            ...(node.children[0].properties.className || []),\n            INLINE_CODE,\n          ];\n\n          return node;\n        }\n\n        if (node.tagName === \"div\") {\n          node.properties.className = [\n            ...(node.properties.className || []),\n            BLOCK,\n          ];\n\n          node.children = node.children.map((node: any) => {\n            if (\n              node.tagName === \"div\" &&\n              typeof node.properties?.[\"data-rehype-pretty-code-title\"] !==\n                \"undefined\"\n            ) {\n              node.properties.className = [\n                ...(node.properties.className || []),\n                TITLE,\n              ];\n            }\n            if (node.tagName === \"pre\") {\n              node.properties.className = [PRE];\n              if (node.children[0].tagName === \"code\") {\n                node.children[0].properties.className = [\n                  ...(node.children[0].properties.className || []),\n                  CODE,\n                ];\n                if (\n                  typeof node.children[0].properties[\"data-line-numbers\"] !==\n                  \"undefined\"\n                ) {\n                  node.children[0].properties.className.push(NUMBERED_LINES);\n                }\n              }\n            }\n\n            return node;\n          });\n\n          return node;\n        }\n      }\n    );\n  };\n}\n\nexport const rehypePrettyCodeOptions: Partial<Options> = {\n  theme: \"one-dark-pro\",\n  tokensMap: {\n    // VScode command palette: Inspect Editor Tokens and Scopes\n    // https://github.com/Binaryify/OneDark-Pro/blob/47c66a2f2d3e5c85490e1aaad96f5fab3293b091/themes/OneDark-Pro.json\n    fn: \"entity.name.function\",\n    objKey: \"meta.object-literal.key\",\n  },\n  onVisitLine(node) {\n    // Prevent lines from collapsing in `display: grid` mode, and\n    // allow empty lines to be copy/pasted\n    if (node.children.length === 0) {\n      node.children = [{ type: \"text\", value: \" \" }];\n    }\n    node.properties.className = [\"\"];\n  },\n  onVisitHighlightedLine(node) {\n    node.properties.className.push(\"highlighted \" + HIGHLIGHTED_LINE);\n  },\n  onVisitHighlightedWord(node) {\n    node.properties.className = [\"word\"];\n  },\n};\n"],
  "mappings": "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",
  "names": ["node"]
}
